{
  "id": "controlnet-tile-upscale-v1",
  "revision": 0,
  "last_node_id": 92,
  "last_link_id": 200,
  "nodes": [
    {
      "id": 8,
      "type": "VAEDecode",
      "pos": [
        1450,
        420
      ],
      "size": [
        210,
        46
      ],
      "flags": {},
      "order": 20,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 89
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 40
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            151
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAEDecode"
      },
      "widgets_values": []
    },
    {
      "id": 75,
      "type": "VAEDecode",
      "pos": [
        1220,
        -150
      ],
      "size": [
        210,
        46
      ],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 148
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 146
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            147,
            190
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAEDecode"
      },
      "widgets_values": []
    },
    {
      "id": 74,
      "type": "PreviewImage",
      "pos": [
        1500,
        -150
      ],
      "size": [
        600,
        500
      ],
      "flags": {},
      "order": 18,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 147
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 5,
      "type": "EmptyLatentImage",
      "pos": [
        360,
        -295
      ],
      "size": [
        315,
        106
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "slot_index": 0,
          "links": [
            83
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "EmptyLatentImage"
      },
      "widgets_values": [
        1152,
        896,
        1
      ]
    },
    {
      "id": 84,
      "type": "StringConcatenate",
      "pos": [
        20,
        360
      ],
      "size": [
        210,
        166
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "string_a",
          "type": "STRING",
          "widget": {
            "name": "string_a"
          },
          "link": 169
        },
        {
          "name": "string_b",
          "type": "STRING",
          "widget": {
            "name": "string_b"
          },
          "link": 168
        },
        {
          "name": "delimiter",
          "type": "STRING",
          "widget": {
            "name": "delimiter"
          },
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "links": [
            171
          ]
        }
      ],
      "title": "Merge positive prompts",
      "properties": {
        "Node name for S&R": "StringConcatenate"
      },
      "widgets_values": [
        "",
        "",
        ", "
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 85,
      "type": "StringConcatenate",
      "pos": [
        20,
        620
      ],
      "size": [
        210,
        166
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [
        {
          "name": "string_a",
          "type": "STRING",
          "widget": {
            "name": "string_a"
          },
          "link": 174
        },
        {
          "name": "string_b",
          "type": "STRING",
          "widget": {
            "name": "string_b"
          },
          "link": 175
        },
        {
          "name": "delimiter",
          "type": "STRING",
          "widget": {
            "name": "delimiter"
          },
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "links": [
            173
          ]
        }
      ],
      "title": "Merge negative prompts",
      "properties": {
        "Node name for S&R": "StringConcatenate"
      },
      "widgets_values": [
        "",
        "",
        ", "
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 47,
      "type": "CLIPTextEncode",
      "pos": [
        340,
        380
      ],
      "size": [
        290,
        88
      ],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 160
        },
        {
          "name": "text",
          "type": "STRING",
          "widget": {
            "name": "text"
          },
          "link": 171
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            191
          ]
        }
      ],
      "title": "Second Pass Positive Encode",
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        ""
      ]
    },
    {
      "id": 76,
      "type": "CLIPTextEncode",
      "pos": [
        340,
        590
      ],
      "size": [
        290,
        88
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 161
        },
        {
          "name": "text",
          "type": "STRING",
          "widget": {
            "name": "text"
          },
          "link": 173
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            192
          ]
        }
      ],
      "title": "Second Pass Negative Encode",
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        ""
      ]
    },
    {
      "id": 29,
      "type": "LoraLoader",
      "pos": [
        -130,
        -236
      ],
      "size": [
        270,
        126
      ],
      "flags": {},
      "order": 6,
      "mode": 4,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 94
        },
        {
          "name": "clip",
          "type": "CLIP",
          "link": 57
        }
      ],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            63,
            95
          ]
        },
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            160,
            161,
            177,
            178
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "LoraLoader"
      },
      "widgets_values": [
        "nsfw-xl-2.1.safetensors",
        0.25,
        0.3
      ]
    },
    {
      "id": 86,
      "type": "CLIPTextEncode",
      "pos": [
        340,
        -50
      ],
      "size": [
        290,
        88
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 177
        },
        {
          "name": "text",
          "type": "STRING",
          "widget": {
            "name": "text"
          },
          "link": 179
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            181
          ]
        }
      ],
      "title": "First Pass Positive Encode",
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        ""
      ]
    },
    {
      "id": 87,
      "type": "CLIPTextEncode",
      "pos": [
        340,
        85
      ],
      "size": [
        290,
        88
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 178
        },
        {
          "name": "text",
          "type": "STRING",
          "widget": {
            "name": "text"
          },
          "link": 180
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            182
          ]
        }
      ],
      "title": "First Pass Negative Encode",
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        ""
      ]
    },
    {
      "id": 81,
      "type": "PrimitiveStringMultiline",
      "pos": [
        -585,
        630
      ],
      "size": [
        520,
        184
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "slot_index": 0,
          "links": [
            174
          ]
        }
      ],
      "title": "Enhancement Negative Terms",
      "properties": {
        "Node name for S&R": "PrimitiveStringMultiline"
      },
      "widgets_values": [
        "smooth skin, airbrushed, perfect skin, beauty filter, poreless, polished skin, flat skin, plastic skin, featureless skin, simplified skin, lack of skin detail, dry lips, matte lips, flat lips, chalky lips, dull lips, dry skin, matte skin, excessive fabric detail, extended fabric, fabric strands, loose threads, wool fibers extending, fabric hallucination, exaggerated textile, blurry hair, soft hair, merged hair strands, filtered, over-processed, blurry, smoothed detail"
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 20,
      "type": "CheckpointLoaderSimple",
      "pos": [
        -575,
        -221
      ],
      "size": [
        344,
        98
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "slot_index": 0,
          "links": [
            94
          ]
        },
        {
          "name": "CLIP",
          "type": "CLIP",
          "slot_index": 1,
          "links": [
            57
          ]
        },
        {
          "name": "VAE",
          "type": "VAE",
          "slot_index": 2,
          "links": [
            40,
            146
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "CheckpointLoaderSimple"
      },
      "widgets_values": [
        "cyberrealisticXL_v70_fp32.safetensors"
      ]
    },
    {
      "id": 27,
      "type": "SaveImage",
      "pos": [
        1730,
        420
      ],
      "size": [
        600,
        450
      ],
      "flags": {},
      "order": 21,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 151
        }
      ],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "Generate_ControlNetTile"
      ]
    },
    {
      "id": 77,
      "type": "PrimitiveStringMultiline",
      "pos": [
        -585,
        -55
      ],
      "size": [
        520,
        180
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "slot_index": 0,
          "links": [
            169,
            179
          ]
        }
      ],
      "title": "Base Positive Prompt",
      "properties": {
        "Node name for S&R": "PrimitiveStringMultiline"
      },
      "widgets_values": [
        "1girl, portrait, detailed face, photorealistic"
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 80,
      "type": "PrimitiveStringMultiline",
      "pos": [
        -580,
        175
      ],
      "size": [
        520,
        180
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "slot_index": 0,
          "links": [
            175,
            180
          ]
        }
      ],
      "title": "Base Negative Prompt",
      "properties": {
        "Node name for S&R": "PrimitiveStringMultiline"
      },
      "widgets_values": [
        "sdxl_cyberrealistic_simpleneg-neg"
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 78,
      "type": "PrimitiveStringMultiline",
      "pos": [
        -585,
        405
      ],
      "size": [
        520,
        177
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "slot_index": 0,
          "links": [
            168
          ]
        }
      ],
      "title": "Enhancement Positive Terms",
      "properties": {
        "Node name for S&R": "PrimitiveStringMultiline"
      },
      "widgets_values": [
        "same person, consistent identity, facial consistency, preserved features, natural skin texture, realistic skin detail, visible pores, skin texture definition, individual pore detail, subtle skin imperfections, natural imperfections, authentic skin texture, facial detail, face texture, cheek texture, body skin detail, torso texture, moist lips, glossy lips, lip sheen, natural lip moisture, skin moisture, dewy skin, natural skin sheen, moisture highlights, detailed hair strands, individual hair texture, natural hair detail, hair strand clarity, refined fabric texture, contained textile detail, sharp focus, enhanced clarity, photographic quality"
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 37,
      "type": "LatentUpscaleBy",
      "pos": [
        870,
        190
      ],
      "size": [
        326,
        82
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 81
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            88
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "LatentUpscaleBy"
      },
      "widgets_values": [
        "bislerp",
        1.5
      ]
    },
    {
      "id": 90,
      "type": "ControlNetLoader",
      "pos": [
        -130,
        -80
      ],
      "size": [
        315,
        58
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CONTROL_NET",
          "type": "CONTROL_NET",
          "links": [
            193
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "ControlNetLoader"
      },
      "widgets_values": [
        "control-lora-sdxl-tile-realistic-v1-fp16.safetensors"
      ]
    },
    {
      "id": 91,
      "type": "ImageUpscaleWithModel",
      "pos": [
        870,
        300
      ],
      "size": [
        315,
        46
      ],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "upscale_model",
          "type": "UPSCALE_MODEL",
          "link": 194
        },
        {
          "name": "image",
          "type": "IMAGE",
          "link": 190
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            195
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "ImageUpscaleWithModel"
      },
      "widgets_values": []
    },
    {
      "id": 88,
      "type": "UpscaleModelLoader",
      "pos": [
        650,
        300
      ],
      "size": [
        315,
        58
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "UPSCALE_MODEL",
          "type": "UPSCALE_MODEL",
          "links": [
            194
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "UpscaleModelLoader"
      },
      "widgets_values": [
        "4x-UltraSharp.pth"
      ]
    },
    {
      "id": 92,
      "type": "ControlNetApplyAdvanced",
      "pos": [
        650,
        380
      ],
      "size": [
        315,
        186
      ],
      "flags": {},
      "order": 19,
      "mode": 0,
      "inputs": [
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 191
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 192
        },
        {
          "name": "control_net",
          "type": "CONTROL_NET",
          "link": 193
        },
        {
          "name": "image",
          "type": "IMAGE",
          "link": 195
        }
      ],
      "outputs": [
        {
          "name": "positive",
          "type": "CONDITIONING",
          "links": [
            196
          ]
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "links": [
            197
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "ControlNetApplyAdvanced"
      },
      "widgets_values": [
        0.7,
        0.0,
        1.0
      ]
    },
    {
      "id": 42,
      "type": "KSampler",
      "pos": [
        1120,
        420
      ],
      "size": [
        270,
        262
      ],
      "flags": {},
      "order": 19,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 95
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 196
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 197
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 88
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            89
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "KSampler"
      },
      "widgets_values": [
        165569843492139,
        "randomize",
        35,
        3.5,
        "dpmpp_2m_sde",
        "karras",
        0.35
      ]
    },
    {
      "id": 30,
      "type": "KSampler",
      "pos": [
        890,
        -145
      ],
      "size": [
        270,
        262
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 63
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 181
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 182
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 83
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            81,
            148
          ]
        }
      ],
      "title": "KSampler Pass 1",
      "properties": {
        "Node name for S&R": "KSampler"
      },
      "widgets_values": [
        711553448522425,
        "randomize",
        37,
        4,
        "dpmpp_2m_sde",
        "karras",
        1
      ]
    },
    {
      "id": 93,
      "type": "Note",
      "pos": [
        -585,
        870
      ],
      "size": [
        520,
        220
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {
        "text": ""
      },
      "widgets_values": [
        "CONTROLNET TILE UPSCALE WORKFLOW\n\nThis approach uses ControlNet Tile to preserve identity during upscaling.\n\nKey improvements:\n\u2713 Bislerp upscaling (smoother than nearest-exact)\n\u2713 ControlNet Tile preserves structure from Pass 1\n\u2713 Lower CFG (3.5) prevents over-correction\n\u2713 Lower denoise (0.35) reduces identity drift\n\u2713 Identity preservation terms in prompts\n\nPass 1: 1152x896 \u2192 CFG 4, Steps 37\nPass 2: 1728x1344 \u2192 CFG 3.5, Steps 35, Denoise 0.35\n\nQuality: Excellent | Speed: Fast | Identity Preservation: Very Good\n\nRequires: control-lora-sdxl-tile-realistic-v1-fp16.safetensors\nOptional: 4x-UltraSharp.pth for pixel upscale reference"
      ],
      "color": "#432",
      "bgcolor": "#653"
    }
  ],
  "links": [
    [
      40,
      20,
      2,
      8,
      1,
      "VAE"
    ],
    [
      57,
      20,
      1,
      29,
      1,
      "CLIP"
    ],
    [
      63,
      29,
      0,
      30,
      0,
      "MODEL"
    ],
    [
      81,
      30,
      0,
      37,
      0,
      "LATENT"
    ],
    [
      83,
      5,
      0,
      30,
      3,
      "LATENT"
    ],
    [
      88,
      37,
      0,
      42,
      3,
      "LATENT"
    ],
    [
      89,
      42,
      0,
      8,
      0,
      "LATENT"
    ],
    [
      94,
      20,
      0,
      29,
      0,
      "MODEL"
    ],
    [
      95,
      29,
      0,
      42,
      0,
      "MODEL"
    ],
    [
      146,
      20,
      2,
      75,
      1,
      "VAE"
    ],
    [
      147,
      75,
      0,
      74,
      0,
      "IMAGE"
    ],
    [
      148,
      30,
      0,
      75,
      0,
      "LATENT"
    ],
    [
      151,
      8,
      0,
      27,
      0,
      "IMAGE"
    ],
    [
      160,
      29,
      1,
      47,
      0,
      "CLIP"
    ],
    [
      161,
      29,
      1,
      76,
      0,
      "CLIP"
    ],
    [
      168,
      78,
      0,
      84,
      1,
      "STRING"
    ],
    [
      169,
      77,
      0,
      84,
      0,
      "STRING"
    ],
    [
      171,
      84,
      0,
      47,
      1,
      "STRING"
    ],
    [
      173,
      85,
      0,
      76,
      1,
      "STRING"
    ],
    [
      174,
      81,
      0,
      85,
      0,
      "STRING"
    ],
    [
      175,
      80,
      0,
      85,
      1,
      "STRING"
    ],
    [
      177,
      29,
      1,
      86,
      0,
      "CLIP"
    ],
    [
      178,
      29,
      1,
      87,
      0,
      "CLIP"
    ],
    [
      179,
      77,
      0,
      86,
      1,
      "STRING"
    ],
    [
      180,
      80,
      0,
      87,
      1,
      "STRING"
    ],
    [
      181,
      86,
      0,
      30,
      1,
      "CONDITIONING"
    ],
    [
      182,
      87,
      0,
      30,
      2,
      "CONDITIONING"
    ],
    [
      190,
      75,
      0,
      91,
      1,
      "IMAGE"
    ],
    [
      191,
      47,
      0,
      92,
      0,
      "CONDITIONING"
    ],
    [
      192,
      76,
      0,
      92,
      1,
      "CONDITIONING"
    ],
    [
      193,
      90,
      0,
      92,
      2,
      "CONTROL_NET"
    ],
    [
      194,
      88,
      0,
      91,
      0,
      "UPSCALE_MODEL"
    ],
    [
      195,
      91,
      0,
      92,
      3,
      "IMAGE"
    ],
    [
      196,
      92,
      0,
      42,
      1,
      "CONDITIONING"
    ],
    [
      197,
      92,
      1,
      42,
      2,
      "CONDITIONING"
    ]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.85,
      "offset": [
        800,
        400
      ]
    }
  },
  "version": 0.4
}