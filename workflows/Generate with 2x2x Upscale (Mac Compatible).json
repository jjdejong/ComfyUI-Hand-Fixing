{"id":"generate-2x2x-mac-compatible","revision":0,"last_node_id":110,"last_link_id":250,"nodes":[{"id":1,"type":"CheckpointLoaderSimple","pos":[-575,-221],"size":[344,98],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[{"name":"MODEL","type":"MODEL","slot_index":0,"links":[1,2,3]},{"name":"CLIP","type":"CLIP","slot_index":1,"links":[4]},{"name":"VAE","type":"VAE","slot_index":2,"links":[5,6,7]}],"properties":{"Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["cyberrealisticXL_v70_fp32.safetensors"]},{"id":2,"type":"LoraLoader","pos":[-130,-236],"size":[270,126],"flags":{},"order":5,"mode":4,"inputs":[{"name":"model","type":"MODEL","link":1},{"name":"clip","type":"CLIP","link":4}],"outputs":[{"name":"MODEL","type":"MODEL","links":[10]},{"name":"CLIP","type":"CLIP","links":[11,12,13,14,15,16]}],"properties":{"Node name for S&R":"LoraLoader"},"widgets_values":["nsfw-xl-2.1.safetensors",0.25,0.3]},{"id":10,"type":"PrimitiveStringMultiline","pos":[-585,-55],"size":[520,180],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[{"name":"STRING","type":"STRING","slot_index":0,"links":[20,21,22]}],"title":"Base Positive Prompt","properties":{"Node name for S&R":"PrimitiveStringMultiline"},"widgets_values":["1girl, portrait, detailed face, natural expression, photorealistic, professional photography, soft lighting"],"color":"#232","bgcolor":"#353"},{"id":11,"type":"PrimitiveStringMultiline","pos":[-580,175],"size":[520,180],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[{"name":"STRING","type":"STRING","slot_index":0,"links":[23,24,25]}],"title":"Base Negative Prompt","properties":{"Node name for S&R":"PrimitiveStringMultiline"},"widgets_values":["sdxl_cyberrealistic_simpleneg-neg"],"color":"#322","bgcolor":"#533"},{"id":12,"type":"PrimitiveStringMultiline","pos":[-585,405],"size":[520,177],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[{"name":"STRING","type":"STRING","slot_index":0,"links":[26,27]}],"title":"Enhancement Positive Terms","properties":{"Node name for S&R":"PrimitiveStringMultiline"},"widgets_values":["same person, consistent identity, facial consistency, preserved features, natural skin texture, realistic skin detail, visible pores, skin texture definition, individual pore detail, subtle skin imperfections, natural imperfections, authentic skin texture, facial detail, face texture, cheek texture, body skin detail, torso texture, moist lips, glossy lips, lip sheen, natural lip moisture, skin moisture, dewy skin, natural skin sheen, moisture highlights, detailed hair strands, individual hair texture, natural hair detail, hair strand clarity, refined fabric texture, contained textile detail, sharp focus, enhanced clarity, photographic quality"],"color":"#232","bgcolor":"#353"},{"id":13,"type":"PrimitiveStringMultiline","pos":[-585,630],"size":[520,184],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[{"name":"STRING","type":"STRING","slot_index":0,"links":[28,29]}],"title":"Enhancement Negative Terms","properties":{"Node name for S&R":"PrimitiveStringMultiline"},"widgets_values":["smooth skin, airbrushed, perfect skin, beauty filter, poreless, polished skin, flat skin, plastic skin, featureless skin, simplified skin, lack of skin detail, dry lips, matte lips, flat lips, chalky lips, dull lips, dry skin, matte skin, excessive fabric detail, extended fabric, fabric strands, loose threads, wool fibers extending, fabric hallucination, exaggerated textile, blurry hair, soft hair, merged hair strands, filtered, over-processed, blurry, smoothed detail"],"color":"#322","bgcolor":"#533"},{"id":20,"type":"CLIPTextEncode","pos":[340,-50],"size":[290,88],"flags":{},"order":9,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":11},{"name":"text","type":"STRING","widget":{"name":"text"},"link":20}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[30]}],"title":"Generation Positive","properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":[""]},{"id":21,"type":"CLIPTextEncode","pos":[340,85],"size":[290,88],"flags":{},"order":10,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":12},{"name":"text","type":"STRING","widget":{"name":"text"},"link":23}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[31]}],"title":"Generation Negative","properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":[""]},{"id":22,"type":"StringConcatenate","pos":[20,360],"size":[210,166],"flags":{},"order":7,"mode":0,"inputs":[{"name":"string_a","type":"STRING","widget":{"name":"string_a"},"link":21},{"name":"string_b","type":"STRING","widget":{"name":"string_b"},"link":26}],"outputs":[{"name":"STRING","type":"STRING","links":[32]}],"title":"Merge First 2x Positive","properties":{"Node name for S&R":"StringConcatenate"},"widgets_values":["","",", "],"color":"#232","bgcolor":"#353"},{"id":23,"type":"StringConcatenate","pos":[20,620],"size":[210,166],"flags":{},"order":6,"mode":0,"inputs":[{"name":"string_a","type":"STRING","widget":{"name":"string_a"},"link":24},{"name":"string_b","type":"STRING","widget":{"name":"string_b"},"link":28}],"outputs":[{"name":"STRING","type":"STRING","links":[33]}],"title":"Merge First 2x Negative","properties":{"Node name for S&R":"StringConcatenate"},"widgets_values":["","",", "],"color":"#322","bgcolor":"#533"},{"id":24,"type":"CLIPTextEncode","pos":[340,380],"size":[290,88],"flags":{},"order":11,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":13},{"name":"text","type":"STRING","widget":{"name":"text"},"link":32}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[34]}],"title":"First 2x Positive","properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":[""]},{"id":25,"type":"CLIPTextEncode","pos":[340,590],"size":[290,88],"flags":{},"order":12,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":14},{"name":"text","type":"STRING","widget":{"name":"text"},"link":33}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[35]}],"title":"First 2x Negative","properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":[""]},{"id":26,"type":"StringConcatenate","pos":[20,880],"size":[210,166],"flags":{},"order":8,"mode":0,"inputs":[{"name":"string_a","type":"STRING","widget":{"name":"string_a"},"link":22},{"name":"string_b","type":"STRING","widget":{"name":"string_b"},"link":27}],"outputs":[{"name":"STRING","type":"STRING","links":[36]}],"title":"Merge Second 2x Positive","properties":{"Node name for S&R":"StringConcatenate"},"widgets_values":["","",", "],"color":"#232","bgcolor":"#353"},{"id":27,"type":"StringConcatenate","pos":[20,1140],"size":[210,166],"flags":{},"order":7,"mode":0,"inputs":[{"name":"string_a","type":"STRING","widget":{"name":"string_a"},"link":25},{"name":"string_b","type":"STRING","widget":{"name":"string_b"},"link":29}],"outputs":[{"name":"STRING","type":"STRING","links":[37]}],"title":"Merge Second 2x Negative","properties":{"Node name for S&R":"StringConcatenate"},"widgets_values":["","",", "],"color":"#322","bgcolor":"#533"},{"id":28,"type":"CLIPTextEncode","pos":[340,900],"size":[290,88],"flags":{},"order":13,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":15},{"name":"text","type":"STRING","widget":{"name":"text"},"link":36}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[38]}],"title":"Second 2x Positive","properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":[""]},{"id":29,"type":"CLIPTextEncode","pos":[340,1110],"size":[290,88],"flags":{},"order":14,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":16},{"name":"text","type":"STRING","widget":{"name":"text"},"link":37}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[39]}],"title":"Second 2x Negative","properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":[""]},{"id":30,"type":"EmptyLatentImage","pos":[360,-295],"size":[315,106],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[{"name":"LATENT","type":"LATENT","slot_index":0,"links":[40]}],"properties":{"Node name for S&R":"EmptyLatentImage"},"widgets_values":[1152,896,1]},{"id":31,"type":"KSampler","pos":[890,-145],"size":[270,262],"flags":{},"order":15,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":10},{"name":"positive","type":"CONDITIONING","link":30},{"name":"negative","type":"CONDITIONING","link":31},{"name":"latent_image","type":"LATENT","link":40}],"outputs":[{"name":"LATENT","type":"LATENT","links":[41]}],"title":"Generation KSampler","properties":{"Node name for S&R":"KSampler"},"widgets_values":[711553448522425,"randomize",37,4,"dpmpp_2m_sde","karras",1]},{"id":32,"type":"VAEDecode","pos":[1220,-150],"size":[210,46],"flags":{},"order":16,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":41},{"name":"vae","type":"VAE","link":5}],"outputs":[{"name":"IMAGE","type":"IMAGE","slot_index":0,"links":[42,43]}],"properties":{"Node name for S&R":"VAEDecode"},"widgets_values":[]},{"id":33,"type":"PreviewImage","pos":[1500,-150],"size":[600,400],"flags":{},"order":17,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":42}],"outputs":[],"title":"Preview: Base Generation","properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":40,"type":"UpscaleModelLoader","pos":[650,300],"size":[315,58],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[{"name":"UPSCALE_MODEL","type":"UPSCALE_MODEL","links":[50,51]}],"properties":{"Node name for S&R":"UpscaleModelLoader"},"widgets_values":["RealESRGAN_x2plus.pth"]},{"id":41,"type":"UltimateSDUpscale","pos":[650,400],"size":[315,614],"flags":{},"order":18,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":43},{"name":"model","type":"MODEL","link":2},{"name":"positive","type":"CONDITIONING","link":34},{"name":"negative","type":"CONDITIONING","link":35},{"name":"vae","type":"VAE","link":6},{"name":"upscale_model","type":"UPSCALE_MODEL","link":50}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[52,53]}],"title":"First 2x Upscale (→2304x1792)","properties":{"Node name for S&R":"UltimateSDUpscale"},"widgets_values":[2.0,165569843492139,28,3.5,"dpmpp_2m_sde","karras",0.32,"Linear",512,512,32,32,"None",1,64,8,16,true,false]},{"id":42,"type":"PreviewImage","pos":[1020,400],"size":[600,400],"flags":{},"order":19,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":52}],"outputs":[],"title":"Preview: After First 2x","properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":43,"type":"UltimateSDUpscale","pos":[650,1080],"size":[315,614],"flags":{},"order":20,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":53},{"name":"model","type":"MODEL","link":3},{"name":"positive","type":"CONDITIONING","link":38},{"name":"negative","type":"CONDITIONING","link":39},{"name":"vae","type":"VAE","link":7},{"name":"upscale_model","type":"UPSCALE_MODEL","link":51}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[54]}],"title":"Second 2x Upscale (→4608x3584)","properties":{"Node name for S&R":"UltimateSDUpscale"},"widgets_values":[2.0,165569843492140,25,3.0,"dpmpp_2m_sde","karras",0.26,"Linear",512,512,32,32,"None",1,64,8,16,true,false]},{"id":44,"type":"SaveImage","pos":[1020,1080],"size":[600,450],"flags":{},"order":21,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":54}],"outputs":[],"properties":{},"widgets_values":["Generate_2x2x_Mac"]},{"id":50,"type":"Note","pos":[-585,870],"size":[520,440],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[],"properties":{"text":""},"widgets_values":["MAC-COMPATIBLE: GENERATION + 2x → 2x UPSCALE WORKFLOW\n\nOptimized for Apple Silicon (M1/M2/M3/M4) - NO TEARING!\n\nUses RealESRGAN_x2plus.pth which is fully compatible with Mac MPS backend.\nChains two 2x upscales to achieve 4x total upscaling.\n\nPROMPT STRATEGY:\n✓ Base prompts maintained through all passes for context\n✓ Enhancement terms added for detail refinement\n✓ Concatenated separately for each upscale pass\n\nGENERATION PASS (1152x896):\n- CFG: 4, Steps: 37, Denoise: 1.0\n- Sampler: dpmpp_2m_sde + karras\n\nFIRST 2x UPSCALE (→ 2304x1792):\n- Tile: 512x512\n- CFG: 3.5 (moderate)\n- Steps: 28\n- Denoise: 0.32 (moderate for first pass)\n- Upscaler: RealESRGAN_x2plus.pth\n\nSECOND 2x UPSCALE (→ 4608x3584):\n- Tile: 512x512\n- CFG: 3.0 (lower, conservative)\n- Steps: 25\n- Denoise: 0.26 (lighter, already upscaled once)\n- Upscaler: RealESRGAN_x2plus.pth\n\nADVANTAGES:\n✓ Works perfectly on Mac (no tearing)\n✓ Each 2x pass is conservative (no identity drift)\n✓ Combined 4x total upscaling\n✓ Clean output ready for FaceDetailer\n✓ Lower VRAM usage per pass\n\nADJUSTMENTS:\n- First pass denoise: 0.30-0.35 (balance detail vs preservation)\n- Second pass denoise: 0.24-0.28 (lighter touch on pre-upscaled image)\n- If output too smooth: increase denoise slightly\n- If identity drifts: decrease denoise\n\nREQUIRES:\n- Ultimate SD Upscale node\n- RealESRGAN_x2plus.pth\n- Works great on Mac M-series with 16GB+ unified memory"],"color":"#432","bgcolor":"#653"}],"links":[[1,1,0,2,0,"MODEL"],[2,1,0,41,1,"MODEL"],[3,1,0,43,1,"MODEL"],[4,1,1,2,1,"CLIP"],[5,1,2,32,1,"VAE"],[6,1,2,41,4,"VAE"],[7,1,2,43,4,"VAE"],[10,2,0,31,0,"MODEL"],[11,2,1,20,0,"CLIP"],[12,2,1,21,0,"CLIP"],[13,2,1,24,0,"CLIP"],[14,2,1,25,0,"CLIP"],[15,2,1,28,0,"CLIP"],[16,2,1,29,0,"CLIP"],[20,10,0,20,1,"STRING"],[21,10,0,22,0,"STRING"],[22,10,0,26,0,"STRING"],[23,11,0,21,1,"STRING"],[24,11,0,23,0,"STRING"],[25,11,0,27,0,"STRING"],[26,12,0,22,1,"STRING"],[27,12,0,26,1,"STRING"],[28,13,0,23,1,"STRING"],[29,13,0,27,1,"STRING"],[30,20,0,31,1,"CONDITIONING"],[31,21,0,31,2,"CONDITIONING"],[32,22,0,24,1,"STRING"],[33,23,0,25,1,"STRING"],[34,24,0,41,2,"CONDITIONING"],[35,25,0,41,3,"CONDITIONING"],[36,26,0,28,1,"STRING"],[37,27,0,29,1,"STRING"],[38,28,0,43,2,"CONDITIONING"],[39,29,0,43,3,"CONDITIONING"],[40,30,0,31,3,"LATENT"],[41,31,0,32,0,"LATENT"],[42,32,0,33,0,"IMAGE"],[43,32,0,41,0,"IMAGE"],[50,40,0,41,5,"UPSCALE_MODEL"],[51,40,0,43,5,"UPSCALE_MODEL"],[52,41,0,42,0,"IMAGE"],[53,41,0,43,0,"IMAGE"],[54,43,0,44,0,"IMAGE"]],"groups":[{"title":"Generation","bounding":[-600,-350,1050,200],"color":"#3f789e","font_size":24},{"title":"Prompts","bounding":[-600,150,650,680],"color":"#8A8A00","font_size":24},{"title":"Prompt Encoding - Generation & First 2x","bounding":[10,-70,640,780],"color":"#88AA88","font_size":24},{"title":"First 2x Upscale","bounding":[640,280,1000,750],"color":"#A87A3A","font_size":24},{"title":"Second 2x Upscale","bounding":[640,1050,1000,680],"color":"#8A5082","font_size":24},{"title":"Prompt Encoding - Second 2x","bounding":[10,860,640,460],"color":"#3f789e","font_size":24}],"config":{},"extra":{"ds":{"scale":0.7,"offset":[900,200]}},"version":0.4}
